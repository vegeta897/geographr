<h2>Location <small>({{ user.location | grid }})</small></h2>
<p><span class="text-muted">Terrain:</span>&emsp;{{ onPixel.terrain }}&emsp;&emsp;&emsp;
    <span class="text-muted">Elevation:</span>&emsp;{{ onPixel.elevation }}</p>
<p ng-hide="onPixel.camp" class="text-muted">Nothing here.</p>
<button ng-disabled="looking" ng-hide="onPixel.campfire || onPixel.camp" class="btn btn-default btn-sm"
    ng-click="buildCampfire()">Build Campfire</button>
<div class="well object-well" ng-show="onPixel.campfire">
    Campfire
</div>
<div class="well object-well" ng-show="onPixel.camp">
    <div class="row"><div class="col-xs-12">
        <h3 class="pull-left">{{ onPixel.camp | itemDisplay }}</h3>
        <button class="btn btn-default btn-sm pull-right" ng-click="showEco = !showEco">Resources</button>
        <table class="unstyled" ng-show="showEco">
            <tr><th>Resource</th><th class="text-right">Supply</th><th class="text-right">Demand</th></tr>
            <tr ng-repeat-start="(key,val) in onPixel.camp.economy.resources"
                ng-show="showAllRes || (val.supply > 0 || val.invItem || 
                    hasItem({profession:'blacksmith',name:key}))">
                <td><button data-toggle-panel class="btn btn-xs btn-item"
                    ng-style="{'background-color': '#'+val.color}">{{ key | capitalize }}</button></td>
                <td class="text-right change-effect" data-model="val.supply" data-plain="true"
                    ng-class="{'text-muted': val.supply < 1}">{{ val.supply }}</td>
                <td style="color: #fff;" class="text-right" ng-style="{opacity:(val.demand+15)/115}">
                    {{ val.invItem | iif : '*' : '' }}{{ val.demand }}</td>
            </tr>
            <tr class="actions" ng-repeat-end><td colspan="3">
                <div class="well well-sm">
                    <div class="row">
                        <div class="input-group input-group-sm col-xs-7 hard-right"
                             ng-class="{ 'has-error': buyAmount > val.supply }">
                            <input class="form-control input-sm text-center" type="text"
                                ng-model="buyAmount" ng-init="buyAmount = 1" id="inputBuyAmount">
                            <span class="input-group-btn">
                                <button ng-disabled="buyAmount > val.supply" class="btn btn-default btn-sm"
                                    ng-click="buyResource(key,buyAmount)">Buy</button>
                                <button class="btn btn-default btn-sm free" ng-click="buyAmount = 1">1</button>
                                <button class="btn btn-default btn-sm free" 
                                    ng-click="buyAmount = val.supply">All</button>
                            </span>
                        </div>
                        <div class="col-xs-4 text-right hard-right">
                            <span class="text-muted">Cost: </span>
                            <strong ng-class="{'text-danger': (buyAmount * val.value > user.money)}">
                                {{ buyAmount * val.value | int }}</strong>
                        </div>
                    </div>
                    <div class="row" ng-show="val.invItem">
                        <div class="input-group input-group-sm col-xs-7 hard-right"
                             ng-class="{ 'has-error': sellAmount > val.invItem.amount }">
                            <input class="form-control input-sm text-center" type="text" ng-model="sellAmount"
                                ng-init="sellAmount = val.invItem.amount || 1" id="inputSellAmount">
                            <span class="input-group-btn">
                            <button ng-disabled="sellAmount > val.invItem.amount" class="btn btn-default btn-sm"
                                ng-click="sellResource(val.invItem,sellAmount,val.value)">Sell</button>
                            <button class="btn btn-default btn-sm free" ng-click="sellAmount = 1">1</button>
                            <button class="btn btn-default btn-sm free"
                                ng-click="sellAmount = val.invItem.amount">All</button>
                            </span>
                        </div>
                        <div class="col-xs-4 text-right hard-right">
                            <span class="text-muted">Value: </span>
                            <strong>{{ sellAmount * val.value * 0.8 | int }}</strong>
                        </div>
                    </div>
                </div>
            </td></tr>
            <tr><td colspan="3"><div class="checkbox-inline text-muted"><label>
                <input ng-model="showAllRes" type="checkbox">
                Show All Resources
            </label></div></td></tr>
        </table>
    </div></div>
    <button ng-show="onPixel.camp.economy.blacksmith && hasItem({profession:'blacksmith'})"
            class="btn btn-default btn-sm" ng-click="showBS = !showBS">Blacksmith</button>
    <div ng-show="showBS && hasItem({profession:'blacksmith'})" class="row"><div class="col-xs-12">
        <table class="unstyled">
            <tr><th>Unrefined Mineral</th><th class="text-right">Sell</th>
                <th class="text-right">Refine</th></tr>
            <tr ng-repeat-start="item in inventory | typeFilter:['blacksmith']">
                <td><button data-toggle-panel class="btn btn-xs btn-item"
                    ng-style="{'background-color': '#'+item.color}" >{{ item.name | capitalize }}
                </button></td>
                <td class="text-right">
                    {{ onPixel.camp.economy.blacksmith[item.name].value * 0.8 | int }}</td>
                <td class="text-right">
                    {{ onPixel.camp.economy.blacksmith[item.name].value * 2 | int }}</td>
            </tr>
            <tr ng-repeat-end class="actions"><td colspan="3"><div class="well">
                <div class="input-group input-group-sm col-xs-12 hard-left"
                     ng-class="{ 'has-error': blacksmithAmount > item.amount }">
                    <input class="form-control input-sm text-center" type="text"
                        ng-model="blacksmithAmount" ng-init="blacksmithAmount = item.amount"
                        id="inputBlacksmithAmount">
                    <span class="input-group-btn">
                        <button ng-disabled="blacksmithAmount > item.amount" class="btn btn-default btn-sm free" 
                            ng-click="refineItem(item,blacksmithAmount,
                            onPixel.camp.economy.blacksmith[item.name].value)">Refine</button>
                        <button ng-disabled="blacksmithAmount > item.amount"
                            class="btn btn-default btn-sm" ng-click="sellResource(item,
                            blacksmithAmount,onPixel.camp.economy.blacksmith[item.name].value)">Sell</button>
                        <button class="btn btn-default btn-sm" ng-click="blacksmithAmount = 1">1</button>
                        <button class="btn btn-default btn-sm" ng-click="blacksmithAmount = item.amount">All</button>
                    </span>
                </div>
                <div class="row text-only">
                    <div class="col-xs-6">
                        <span class="text-muted">Refine Cost: </span>
                        <strong ng-class="{ 'text-danger': blacksmithAmount > item.amount }">
                            {{ blacksmithAmount * onPixel.camp.economy.blacksmith[item.name].value * 2
                            | int }}</strong>
                    </div>
                    <div class="col-xs-6">
                        <span class="text-muted">Sell Value: </span>
                        <strong ng-class="{ 'text-danger': blacksmithAmount > item.amount }">
                            {{ blacksmithAmount * onPixel.camp.economy.blacksmith[item.name].value * 0.8
                            | int }}</strong>
                    </div></div>
            </div></td></tr>
        </table>
    </div></div>
</div>
<div class="well object-well" ng-repeat="object in onPixel.objects"
     ng-show="onPixel.objects && object.type != 'camp' && !object.activity">{{ object | itemDisplay }}
</div>